import random
from re import T
import datetime
import numpy as np
from sympy import im
from utils.pycui import pycui
import angr
import subprocess
import os
from angr import SimFileStream
import claripy
import itertools
import random
import logging

from pip import main
logging.getLogger('angr.manager').setLevel(logging.INFO) #用来记录日志

color = pycui()
random_scanf_num = []

def format_cases(cases):
    # print(cases)
    new_cases = []
    for case in cases:
        r,c = case[0],case[1]
        # print(r,c)
        # print(case)
        new_cases.append(list(case[:2])+list(case[10:10+r*c]))
    return new_cases


# from angr.procedures.stubs.format_parser import ScanfFormatParser

def pass_cases_to_DSE_and_get_new_case_back_to_GA(pass_cases_,target,visited_addr):
    path_to_binary = os.path.join(target.target_exe_path,target.target_name)
    project = angr.Project(path_to_binary)

    class ReplacementFscanf(angr.SimProcedure):
        def run(self, ptr,format_string_ptr, param0):
            scanf0_address = param0
            a = self.state.memory.load(format_string_ptr, 2)
                # print(a)
            format_str = self.state.solver.eval(a,cast_to=bytes)
            # def drop_state(state):
            #     if "idx" in state.globals.keys():
            #         return state.globals['idx'] > 19
            #     else:
            #         return False
            # simulation.drop(filter_func=drop_state)
            if self.state.globals['concrect'] == 1:
                passed_num = 0
                if self.state.globals['idx'] >= 23:
                    passed_num = 0x0a
                    self.state.memory.store(scanf0_address, passed_num)
                    return 
                else:
                    passed_num = self.state.globals['case'][self.state.globals['idx']]
                # color.info(f"[x] scanf get num: {passed_num}")
                if format_str == b'%f':
                    self.state.memory.store(scanf0_address, claripy.FPV(float(passed_num),sort=self.state.solver.fp.FSORT_FLOAT))

                if format_str == b'%d':
                    self.state.memory.store(scanf0_address,claripy.BVV(int(passed_num),8), endness=project.arch.memory_endness)
                self.state.globals['idx']+=1
                
            else:
                
                num = 0
                # color.error(format_string_ptr)

                if format_str == b'%f':
                    num = random.random()
                    self.state.memory.store(scanf0_address, claripy.FPV(num,sort=self.state.solver.fp.FSORT_FLOAT))

                if format_str == b'%d':
                    num = random.randint(1,3)
                    self.state.memory.store(scanf0_address, claripy.BVV(num,8))
                random_scanf_num.append(num)

                if not self.state.globals['scanf_solutions']:
                    self.state.globals['scanf_solutions'] = [num]
                else:
                    self.state.globals['scanf_solutions'].append(num)
            # scanf1_address = param1
            # self.state.memory.store(scanf1_address, scanf1, endness=project.arch.memory_endness)
            
            return 1
    class ReplacementSscanf(angr.SimProcedure):
        def run(self, address,format_string, param0,param1):
            scanf0 = claripy.BVS('sscanf0', 8)
            scanf1 = claripy.BVS('sscanf1', 8)
            self.state.solver.add(scanf0>1,scanf0<3)
            self.state.solver.add(scanf1>1,scanf1<3)
            scanf0_address = param0
            scanf1_address = param1
            if self.state.globals['concrect'] == 1:
                print(self.state.globals['case'])
                print(self.state.globals['idx'])
                passed_num1 = self.state.globals['case'][self.state.globals['idx']]
                color.info(f"[x]sscanf get num1:{passed_num1}")
                self.state.memory.store(scanf0_address,int(passed_num1), endness=project.arch.memory_endness)
                self.state.globals['idx']+=1
                passed_num2 = self.state.globals['case'][self.state.globals['idx']]
                color.info(f"[x]sscanf get num2:{passed_num2}")
                self.state.memory.store(scanf1_address,int(passed_num2), endness=project.arch.memory_endness)
                self.state.globals['idx']+=1
            else:
                self.state.memory.store(scanf0_address,scanf0, endness=project.arch.memory_endness)
                self.state.memory.store(scanf1_address,scanf1, endness=project.arch.memory_endness)
                self.state.globals['sscanf_solutions'] = [scanf0,scanf1]
            return 2

    project.hook_symbol('__isoc99_fscanf', ReplacementFscanf())
    # project.hook_symbol('__isoc99_sscanf', ReplacementSscanf())
    # project.hook_symbol('fgets', ReplacementFgets())

    

    cases = pass_cases_
    # 1.进行具体执行
    print(cases)
    visited_state_addr = visited_addr
    # visited_state = []
    for case in cases:
        color.info(f"concrect case is: {case}")
        initial_state = project.factory.full_init_state(
            args=[path_to_binary]+[str(i) for i in case[:3]],
        )
        simulation = project.factory.simgr(initial_state)
        initial_state.globals['case'] = case
        initial_state.globals['idx'] = 3
        initial_state.globals['concrect'] = 1
    
        while len(simulation.stashes['active'])>0 :
            # print("active length:",len(simulation.stashes['active']))
            for state in simulation.active:
                if state.addr not in visited_state_addr:
                    visited_state_addr.append(state.addr)
                    # visited_state.append(state)
                # print("active state input:  ",state.posix.dumps(0))
                # print("active state output:  ",state.posix.dumps(1))
            #  print(simulation.stashes)
            color.warning(f"visited addr length is:{len(visited_state_addr)}")
            simulation.step()
    color.success(f"DSE store all visited state address:{visited_state_addr}")
    color.success(f"all visited state address length is:{len(visited_state_addr)}")
    # # print(simulation.deadended[0].posix.dumps(0))
    # # print(simulation.deadended[0].posix.dumps(1))
    # # 

    # #2.进行符号执行，获取新的状态地址
    v1 = claripy.BVS('v1', 8)
    v2 = claripy.BVS('v2', 8)
    v3 = claripy.BVS('v3', 8)
    
    initial_state = project.factory.full_init_state(
        args=[path_to_binary]+[v1,v2,v3],
        # input=claripy.Concat(*flags+[claripy.BVV(b'\n')])
        # input=SimFileStream('stdin',content=claripy.BVV(b'2'),has_end=False)
    )
    for i in [v1,v2,v3]:
        initial_state.solver.add(i>0,i<10)
    simulation = project.factory.simgr(initial_state)
    initial_state.globals['concrect'] = 0
    initial_state.globals['scanf_solutions'] = []
    new_states = []
    while simulation.active:
        for state in simulation.active:
            print("active state output:  ",state.posix.dumps(1))
            if state.addr not in visited_state_addr:
                color.success(f'{datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S ")}DSE found the new state!')
                new_states.append(state)

        simulation.step()
        if len(new_states)>1:
            break
    if simulation.unsat:
        print(simulation.unsat[0].solver.constraints)
    
    new_DSE_cases = []
    for new_st in new_states:
        # print("active state input:  ",new_st.posix.dumps(0))
        print("active state output:  ",new_st.posix.dumps(1))
    #     sscanf_stored_solution = new_st.globals['sscanf_solutions']
        scanf_stored_solution = new_st.globals['scanf_solutions']
    #     # print(scanf_stored_solution)
    #     # print(sscanf_stored_solution)
        # if sscanf_stored_solution:
            # tmp = list(map(str, map(new_st.solver.eval, sscanf_stored_solution)))
    #         sscanf0 = tmp[0]
    #         sscanf1 = tmp[1]
    #         print("r&c->",sscanf0,sscanf1)
        print(random_scanf_num)
    #     # random_scanf_num = []
    #     print(scanf_stored_solution)
        if scanf_stored_solution:
            solution_scanf = ' '.join(map(str, map(new_st.solver.eval, scanf_stored_solution)))
            print(solution_scanf)
        
        color.warning("_________________")
        v1v2v3 = []
        for i in [v1,v2,v3]:
            # print(state.solver.eval(i,cast_to=bytes))
            v1v2v3.append(int(state.solver.eval(i)))
        print(v1v2v3)
        nc = v1v2v3 + random_scanf_num
        if len(nc)<23:
            nc += list(np.random.randint(1,8,(23-len(nc))))
        if len(nc) > 23:
            nc = nc[:23]
        print(nc)
        new_DSE_cases.append(nc)
        
        return new_DSE_cases
    # def tmp(state):
    #     color.info(f"active length is:{len(simulation.active)}")
    #     color.info(f"constraint length is:{len(state.solver.constraints)}")
    #     print("active state input:  ",state.posix.dumps(0))
    #     print("active state output:  ",state.posix.dumps(1))

    #     ans = ""
    #     for i in [v1,v2,v3]:
    #         ans += str(state.solver.eval(i))+" "
    #     # for i in flags1:
    #         # ans += str(state.solver.eval(i))+" "
    #     print(ans)
    #     print(random_scanf_num)
    #     scanf_stored_solution = state.globals['scanf_solutions']
    #     if scanf_stored_solution:
    #         tmp = list(map(str, map(state.solver.eval, scanf_stored_solution)))
    #         print(tmp)
    #     out = state.posix.dumps(1)
    #     return b'arrive2' in out
    
    # simulation.explore(find=tmp)
    # print("finished simulation:",simulation.stashes)
    # print(len(simulation.found))
    # if simulation.found:
        # state = simulation.found[0]
    #     color.success("[x]found!!!!!!!!")
    #     print("found state input:  ",state.posix.dumps(0))
    #     print("found state input:  ",state.posix.dumps(1))
    #     ans = ""
    #     for i in [v1,v2,v3]:
    #         ans += str(state.solver.eval(i,cast_to=bytes))+" "
    #     # for i in flags1:
    #         # ans += str(state.solver.eval(i))+" "
    #     print(ans)
    #     print(random_scanf_num)
    #     scanf_stored_solution = state.globals['scanf_solutions']
    #     if scanf_stored_solution:
    #         tmp = list(map(str, map(state.solver.eval, scanf_stored_solution)))
    #         print(tmp)
    # else:
    #     color.error("no found!")


    # initial_state.globals['concrect'] = 0
    # initial_state.globals['scanf_solutions'] = []
    # initial_state.globals['sscanf_solutions'] = []
    # new_states = []
    # while simulation.active:
        # for state in simulation.active:
            # print("active state input:  ",state.posix.dumps(0))
            # print("active state output:  ",state.posix.dumps(1))
            # if state.addr not in visited_state_addr:
                # color.success(f'{datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S ")}DSE found the new state!')
                # new_states.append(state)
        # simulation.step()
        # if len(new_states)>3:
            # break
    # if simulation.unsat:
    #     print(simulation.unsat[0].solver.constraints)

   
if __name__ == "__main__":
    from main_totinfo import Target
    target = Target(num_points_=12,exe_path_=os.path.join(os.path.abspath(os.path.dirname(__file__)),"schedule","source.alt"),target_name_="schedule")   
    cases = [
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","2","7","6","7","6","5","7","1","8","7","1","6","4","2","9","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","1","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","9","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","1","8","1","8","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","5","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","2","7","6","7","6","5","7","1","8","7","1","6","4","2","9","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","1","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","9","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "4","4","6","9","7","6","7","6","5","7","1","6","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","8","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "1","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","9","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","5","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","2","7","6","7","6","5","7","1","8","7","1","6","4","2","9","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","1","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","9","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","1","8","1","8","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","5","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","2","7","6","7","6","5","7","1","8","7","1","6","4","2","9","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","1","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","9","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","8","4","3","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","5","7","1","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","2","7","6","7","6","5","7","1","8","7","1","6","4","2","9","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","1","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","9","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","1","8","1","8","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","5","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","2","7","6","7","6","5","7","1","8","7","1","6","4","2","9","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","1","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","9","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "4","4","6","9","7","6","7","6","5","7","1","6","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","8","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "1","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","9","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","5","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","2","7","6","7","6","5","7","1","8","7","1","6","4","2","9","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","1","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","9","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","1","8","1","8","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","5","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","2","7","6","7","6","5","7","1","8","7","1","6","4","2","9","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","1","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","9","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
# [ "1","4","6","9","7","6","7","6","5","7","1","8","7","1","6","4","2","1","2","1","4","5","3","2","9","9","9","1","6","2","4","8","8","6","2","3","6","3","5","5","7","7","1","4","6","8","2","8","5","1","3","8","5","9","8","5","3","6","5","1","4","4","9","7","6","1","7","8","6","5","3","9","7","1","4","9","4","4","4","1","5","5","5","1","2","7","6","1","1","9","6","7","5","7","5","4","5","4","2","7","6","9","3" ],
# [ "4","5","7","2","6","1","9","6","8","4","3","1","8","1","5","8","9","2","4","3","1","8","2","1","4","8","8","5","6","3","1","8","8","7","6","6","7","8","8","9","5","4","7","3","2","4","6","1","3","7","7","1","7","5","8","9","8","3","7","6","6","5","6","6","5","7","2","9","6","3","6","3","4","1","3","9","2","1","5","9","5","7","2","9","6","1","3","6","8","3","1","2","5","4","1","5","2","8","5","2","3","4","4" ],
]
    pass_cases_to_DSE_and_get_new_case_back_to_GA(cases,target)